// Sign up at https://vincario.com/create-account/ and request API keys
// See API documentation at https://vincario.com/api-docs/3.2/

using System;
using System.Net;
using System.Security.Cryptography;
using System.Text;
using System.IO;

namespace Test
{
    public class Program
    {
        private const string apiBaseUrl = "https://api.vincario.com/3.2";
        private const string apiKey = "API_KEY";
        private const string secretKey = "SECRET_KEY";

        public static void Main(string[] args)
        {
            string vin = "WF0MXXGBWM8R43240";

            WebClient webClient = new WebClient();
            SHA1Managed sha1 = new SHA1Managed();

            String controlSumRaw = string.Concat(vin, "|info|", apiKey, "|", secretKey);
            String controlSumComputed = BitConverter.ToString(sha1.ComputeHash(Encoding.UTF8.GetBytes(controlSumRaw))).Replace("-", "").Substring(0, 10);

            string requestUrl = string.Format(apiBaseUrl + "/" + apiKey + "/" + controlSumComputed + "/decode/info/" + vin + ".json");

            byte[] _data = webClient.DownloadData(requestUrl);
            Stream _mem = new MemoryStream(_data);
            var reader = new StreamReader(_mem);
            var result = reader.ReadToEnd();

            Console.WriteLine(result);
        }
    }
}